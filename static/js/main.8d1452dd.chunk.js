(this.webpackJsonppotado=this.webpackJsonppotado||[]).push([[0],{167:function(e,t,a){e.exports=a.p+"static/media/logo.79967085.png"},173:function(e,t,a){e.exports=a(306)},208:function(e,t,a){},258:function(e,t,a){},259:function(e,t,a){},261:function(e,t,a){},262:function(e,t,a){},265:function(e,t,a){},266:function(e,t,a){},271:function(e,t,a){},272:function(e,t,a){},298:function(e,t,a){},299:function(e,t,a){},300:function(e,t,a){},301:function(e,t,a){},303:function(e,t,a){},304:function(e,t,a){},305:function(e,t,a){},306:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(8),c=a.n(r),s=a(24),i=a(72),l=a(56),d=Object(i.b)({todos:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_TODO":return[t.payload].concat(Object(l.a)(e));case"INIT_TODOS":return Object(l.a)(t.payload);case"UPDATE_TODO":return e.map((function(e){return e.id===t.payload.id?t.payload:e}));case"EDIT_TODO":return e.map((function(e){return e.id===t.payload?Object.assign({},e,{editing:!0}):Object.assign({},e,{editing:!1})}));default:return e}},tomatoes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_TOMATO":return[t.payload].concat(Object(l.a)(e));case"INIT_TOMATOES":return Object(l.a)(t.payload);case"UPDATE_TOMATO":return e.map((function(e){return e.id===t.payload.id?t.payload:e}));default:return e}}}),u=Object(i.c)(d),p=a(62),m=a(57),h=a(30),f=(a(182),a(169)),v=(a(308),a(127)),E=(a(85),a(7)),y=a(15),b=a.n(y),g=(a(65),a(20)),T=a(38),O={addTodo:function(e){return{type:"ADD_TODO",payload:e}},initTodos:function(e){return{type:"INIT_TODOS",payload:e}},updateTodo:function(e){return{type:"UPDATE_TODO",payload:e}},editTodo:function(e){return{type:"EDIT_TODO",payload:e}}},k={addTomato:function(e){return{type:"ADD_TOMATO",payload:e}},initTomatoes:function(e){return{type:"INIT_TOMATOES",payload:e}},updateTomato:function(e){return{type:"UPDATE_TOMATO",payload:e}}},j=Object(h.a)({},O,{},k),C=a(159),N=a.n(C),w=a(35),D=Object(w.b)(),x=N.a.create({baseURL:"https://gp-server.hunger-valley.com/",headers:{"t-app-id":"nM5mG7x9MSDwWD4NMoNCLYE4","t-app-secret":"VAAyTtmgzQhn4rks36XBYQfi"}});x.interceptors.request.use((function(e){var t=localStorage.getItem("x-token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),(function(e){return console.error(e),Promise.reject(e)})),x.interceptors.response.use((function(e){return e.headers["x-token"]&&localStorage.setItem("x-token",e.headers["x-token"]),e}),(function(e){return 401===e.response.status&&D.push("/login"),Promise.reject(e)}));var S,_=x,P="deleted",A="completed",B="incomplete",I="finished",M="unfinished",U="aborted",K=a(160),H=a.n(K),W=a(310),F=a(309),z=function(e){return e.todos},J=function(e,t){var a=z(e),n=function(e){return z(e).filter((function(e){return!e.deleted}))}(e);switch(t){case P:return a.filter((function(e){return e.deleted}));case A:return n.filter((function(e){return e.completed}));case B:return n.filter((function(e){return!e.completed}));default:return n}},L=function(e,t){var a=function(e){return e.tomatoes}(e);switch(t){case I:return a.filter((function(e){return e.description&&e.ended_at&&!e.aborted}));case M:return a.filter((function(e){return!e.description&&!e.ended_at&&!e.aborted}))[0];case U:return a.filter((function(e){return!e.ended_at&&e.aborted}));default:return t}},Q=function(e,t){return H.a.groupBy(e,(function(e){return Object(W.a)(Object(F.a)(e[t]),"yyyy-MM-dd")}))},Y=(a(66),a(37)),q=(a(208),function(e){var t=o.a.useState(""),a=Object(T.a)(t,2),n=a[0],r=a[1],c=function(){return""!==n||(g.a.warning("\u8fd8\u662f\u8bf4\u70b9\u513f\u4ec0\u4e48\u5427"),!1)},s=function(){var t;return b.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,b.a.awrap(_.post("todos",{description:n}));case 3:t=a.sent,r(""),e.addTodo(t.data.resource),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),g.a.error("\u7f51\u7edc\u597d\u50cf\u6709\u70b9\u4e0d\u592a\u597d\u54e6\uff0c\u4e00\u4f1a\u513f\u518d\u8bd5\u5427");case 11:case"end":return a.stop()}}),null,null,[[0,8]])},i=n?o.a.createElement(E.a,{type:"enter",onClick:function(){c()&&s()}}):o.a.createElement("span",null);return o.a.createElement("div",{className:"todo-input"},o.a.createElement(Y.a,{placeholder:"\u6dfb\u52a0\u65b0\u4efb\u52a1",suffix:i,value:n,onChange:function(e){r(e.target.value)},onKeyUp:function(e){13===e.keyCode&&c()&&s()}}))}),G=(a(256),a(170)),R=a(2),V=a.n(R),X=(a(258),function(e){var t=o.a.useState(e.description),a=Object(T.a)(t,2),n=a[0],r=a[1],c=function(){return""!==n||(g.a.warning("\u8fd8\u662f\u8bf4\u70b9\u513f\u4ec0\u4e48\u5427"),!1)},s=function(t){var a;return b.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t.completed&&(t.completed_at=new Date),n.prev=1,n.next=4,b.a.awrap(_.put("todos/".concat(e.id),t));case 4:a=n.sent,e.updateTodo(a.data.resource),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(1),g.a.error("\u7f51\u7edc\u597d\u50cf\u6709\u70b9\u4e0d\u592a\u597d\u54e6\uff0c\u4e00\u4f1a\u513f\u518d\u8bd5\u5427");case 11:case"end":return n.stop()}}),null,null,[[1,8]])},i=o.a.createElement("div",{className:"edit-filed"},o.a.createElement("input",{type:"text",value:n,onChange:function(e){r(e.target.value)},onKeyUp:function(e){13===e.keyCode&&c()&&s({description:n})}}),o.a.createElement("div",{className:"icon-wrapper"},o.a.createElement(E.a,{type:"enter",onClick:function(){c()&&s({description:n})}}),o.a.createElement(E.a,{type:"delete",theme:"filled",onClick:function(){s({deleted:!0})}}))),l=o.a.createElement("span",{className:"text",onDoubleClick:function(){e.editTodo(e.id)}},n),d=V()({"todo-item":!0,editing:e.editing,completed:e.completed});return o.a.createElement("div",{className:d},o.a.createElement(G.a,{checked:e.completed,onChange:function(e){s({completed:e.target.checked})}}),e.editing?i:l)}),$=(a(259),{addTodo:j.addTodo,editTodo:j.editTodo,updateTodo:j.updateTodo}),Z=Object(s.b)((function(e,t){var a=J(e,B);return Object(h.a)({incompleteTodos:a},t)}),$)((function(e){return o.a.createElement("div",{className:"todos"},o.a.createElement(q,{addTodo:e.addTodo}),o.a.createElement("div",{className:"todo-list"},e.incompleteTodos.map((function(t){return o.a.createElement(X,Object.assign({key:t.id},t,{updateTodo:e.updateTodo,editTodo:e.editTodo}))}))))})),ee=(a(59),a(21)),te=a(26),ae=a(27),ne=a(29),oe=a(28),re=a(31),ce=(a(149),a(99)),se=(a(261),function(e){function t(e){var a;return Object(te.a)(this,t),(a=Object(ne.a)(this,Object(oe.a)(t).call(this,e))).startCountDown=function(){S=setInterval((function(){var e=a.state.restTime;a.setState({restTime:e-1e3}),document.title="".concat(a.clock," - \u6709\u4e00\u4e2a\u756a\u8304\u6b63\u5728\u8fdb\u884c"),e<1e3&&a.onTimeOver()}),1e3)},a.onTimeOver=function(){a.props.onFinish(),clearInterval(S)},a.state={restTime:a.props.restTime},a}return Object(re.a)(t,e),Object(ae.a)(t,[{key:"componentDidMount",value:function(){this.startCountDown()}},{key:"componentWillUnmount",value:function(){this.onTimeOver()}},{key:"render",value:function(){var e=1-this.state.restTime/this.props.duration;return o.a.createElement("div",{className:"count-down"},o.a.createElement("span",null,this.clock),o.a.createElement("div",{className:"progress-bar",style:{width:"".concat(100*e,"%")}}))}},{key:"clock",get:function(){var e=Math.floor(this.state.restTime/1e3/60),t=Math.floor(this.state.restTime/1e3%60);return"".concat(e.toString().padStart(2,"0"),":").concat(t.toString().padStart(2,"0"))}}]),t}(o.a.Component)),ie=(a(262),ce.a.confirm),le=function(e){function t(e){var a;return Object(te.a)(this,t),(a=Object(ne.a)(this,Object(oe.a)(t).call(this,e))).startTomato=function(){var e;return b.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,b.a.awrap(_.post("tomatoes",{duration:15e5}));case 3:e=t.sent,a.props.addTomato(e.data.resource),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),g.a.error("\u7f51\u7edc\u597d\u50cf\u6709\u70b9\u4e0d\u592a\u597d\u54e6\uff0c\u4e00\u4f1a\u513f\u518d\u8bd5\u5427");case 10:case"end":return t.stop()}}),null,null,[[0,7]])},a.onClickCancel=function(){ie({title:"\u60a8\u786e\u5b9a\u8981\u653e\u5f03\u8fd9\u4e2a\u756a\u8304\u5417\uff1f",okText:"\u786e\u8ba4",cancelText:"\u5173\u95ed",onOk:function(){a.abortTomato()}})},a.abortTomato=function(){a.updateTomato({aborted:!0}),document.title="Potado - \u4f60\u7684\u756a\u8304\u571f\u8c46"},a.updateTomato=function(e){var t;return b.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,b.a.awrap(_.put("tomatoes/".concat(a.props.unfinishedTomato.id),e));case 3:t=n.sent,a.props.updateTomato(t.data.resource),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),g.a.error("\u7f51\u7edc\u597d\u50cf\u6709\u70b9\u4e0d\u592a\u597d\u54e6\uff0c\u4e00\u4f1a\u513f\u518d\u8bd5\u5427");case 10:case"end":return n.stop()}}),null,null,[[0,7]])},a.onFinish=function(){a.forceUpdate(),document.title="Potado - \u4f60\u7684\u756a\u8304\u571f\u8c46"},a.onKeyUp=function(e){13===e.keyCode&&a.inputCheck()&&a.addDescription()},a.inputCheck=function(){return""!==a.state.description||(g.a.warning("\u8fd8\u662f\u8bf4\u70b9\u513f\u4ec0\u4e48\u5427"),!1)},a.addDescription=function(){""===a.state.description&&a.setState({description:"\u8fd9\u662f\u4e00\u4e2a\u6ca1\u6709\u63cf\u8ff0\u7684\u756a\u8304"}),a.updateTomato({description:a.state.description,ended_at:new Date}),a.setState({description:""})},a.state={description:""},a}return Object(re.a)(t,e),Object(ae.a)(t,[{key:"render",value:function(){var e,t=this;if(void 0===this.props.unfinishedTomato)e=o.a.createElement(ee.a,{className:"start-button",onClick:this.startTomato},"\u5f00\u59cb\u4e00\u4e2a\u756a\u8304");else{var a=Date.parse(this.props.unfinishedTomato.started_at),n=this.props.unfinishedTomato.duration,r=(new Date).getTime();if(r-a>n)e=o.a.createElement("div",{className:"input-wrapper"},o.a.createElement(Y.a,{value:this.state.description,placeholder:"\u8bf7\u8f93\u5165\u521a\u521a\u5b8c\u6210\u7684\u4efb\u52a1",onChange:function(e){t.setState({description:e.target.value})},onKeyUp:this.onKeyUp}),o.a.createElement(E.a,{type:"close-circle",className:"abort",onClick:this.onClickCancel}));else{var c=n-(r-a);e=o.a.createElement("div",{className:"count-down-wrapper"},o.a.createElement(se,{restTime:c,duration:n,onFinish:this.onFinish}),o.a.createElement(E.a,{type:"close-circle",className:"abort",onClick:this.onClickCancel}))}}return o.a.createElement("div",{className:"tomato-action"},e)}}]),t}(o.a.Component),de=(a(265),function(e){return o.a.createElement("div",{className:"tomato-item"},o.a.createElement("span",{className:"time-range"},Object(W.a)(Object(F.a)(e.started_at),"HH:mm")," - ",Object(W.a)(Object(F.a)(e.ended_at),"HH:mm")),o.a.createElement("span",{className:"description"},e.description))}),ue=function(e){function t(){return Object(te.a)(this,t),Object(ne.a)(this,Object(oe.a)(t).apply(this,arguments))}return Object(re.a)(t,e),Object(ae.a)(t,[{key:"render",value:function(){var e=this,t=this.dates.map((function(t){var a=e.props.finishedTomatoes[t],n=o.a.createElement("div",{className:"title"},o.a.createElement("span",{className:"date-time"},Object(W.a)(new Date(t),"M\u6708d\u65e5")),o.a.createElement("span",{className:"finished-count"},"\u5b8c\u6210\u4e86 ",a.length," \u4e2a\u756a\u8304")),r=o.a.createElement("div",{className:"details"},a.map((function(e){return o.a.createElement(de,Object.assign({key:e.id},e))})));return o.a.createElement("div",{key:t,className:"daily-tomatoes"},n,r)}));return o.a.createElement("div",{className:"tomato-list"},t)}},{key:"dates",get:function(){return Object.keys(this.props.finishedTomatoes).sort((function(e,t){return Date.parse(t)-Date.parse(e)})).splice(0,3)}}]),t}(o.a.Component),pe=(a(266),{addTomato:j.addTomato,updateTomato:j.updateTomato}),me=Object(s.b)((function(e){var t=e.tomatoes,a=L(e,I);return{tomatoes:t,finishedTomatoes:a,unfinishedTomato:L(e,M),finishedTomatoesByDay:Q(a,"started_at")}}),pe)((function(e){return o.a.createElement("div",{className:"tomatoes"},o.a.createElement(le,{addTomato:e.addTomato,updateTomato:e.updateTomato,unfinishedTomato:e.unfinishedTomato}),o.a.createElement(ue,{finishedTomatoes:e.finishedTomatoesByDay}))})),he=function(e){return o.a.createElement("div",{className:"graph"},o.a.createElement("svg",null,o.a.createElement("polygon",{fill:"rgba(201,72,91,.1)",stroke:"rgba(201,72,91,.5)",strokeWidth:"1",points:function(t,a){var n=Object.keys(e.data).sort((function(e,t){return Date.parse(e)-Date.parse(t)})),o=Date.parse(n[0])-864e5;if(o){var r=(new Date).getTime()-o,c=0,s=n.map((function(n){var s=(Date.parse(n)-o)/r*t;0===r&&(s=t);var i=(1-(c+=e.data[n].length)/e.totalFinishCount)*a;return"".concat(s,",").concat(i)}));return["0,".concat(a)].concat(Object(l.a)(s),["".concat(t,",0"),"".concat(t,",").concat(a)]).join(" ")}return"0,".concat(a," ").concat(t,",").concat(a)}(e.width,e.height)})))},fe=(a(157),a(76)),ve=(a(150),a(75)),Ee={1:"\u5468\u4e00",2:"\u5468\u4e8c",3:"\u5468\u4e09",4:"\u5468\u56db",5:"\u5468\u4e94",6:"\u5468\u516d",7:"\u5468\u65e5"},ye=function(e,t){var a=Object(F.a)(e),n=Object(W.a)(a,"M\u6708d\u65e5"),o=Object(W.a)(a,"i");switch(t){case"monthAndDay":return n;case"dayOfWeek":return Ee[o]}},be=function(e,t){for(var a=[],n=0;n<e.length;n+=t)a.push(e.slice(n,n+t));return a},ge=(a(271),function(e){function t(){var e,a;Object(te.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(ne.a)(this,(e=Object(oe.a)(t)).call.apply(e,[this].concat(o)))).updateTodo=function(e){var t;return b.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,b.a.awrap(_.put("todos/".concat(a.props.todo.id),e));case 3:t=n.sent,a.props.updateTodo(t.data.resource),n.next=9;break;case 7:n.prev=7,n.t0=n.catch(0);case 9:case"end":return n.stop()}}),null,null,[[0,7]])},a}return Object(re.a)(t,e),Object(ae.a)(t,[{key:"render",value:function(){var e=this,t=null;"completed"===this.props.type?t=o.a.createElement("span",{className:"time"},Object(W.a)(Object(F.a)(this.props.todo.completed_at),"HH:mm")):"deleted"===this.props.type&&(t=o.a.createElement("span",{className:"time"},ye(this.props.todo.created_at,"monthAndDay")));var a=null;return"completed"===this.props.type?a=o.a.createElement("div",{className:"action"},o.a.createElement("span",{onClick:function(){return e.updateTodo({completed:!1})}},"\u6062\u590d"),o.a.createElement("span",{onClick:function(){return e.updateTodo({deleted:!0})}},"\u5220\u9664")):"deleted"===this.props.type&&(a=o.a.createElement("div",{className:"action"},o.a.createElement("span",{onClick:function(){return e.updateTodo({deleted:!1})}},"\u6062\u590d"))),o.a.createElement("div",null,o.a.createElement("div",{className:"todo-history-item"},o.a.createElement("div",{className:"text"},t,o.a.createElement("span",{className:"description"},this.props.todo.description)),a))}}]),t}(o.a.Component)),Te={updateTodo:j.updateTodo},Oe=Object(s.b)((function(e,t){return Object(h.a)({},t)}),Te)(ge),ke=(a(272),ve.a.TabPane),je=function(e){return e.dates.map((function(t){var a=e.todos[t];return o.a.createElement("div",{key:t,className:"daily-todos"},o.a.createElement("div",{className:"title"},o.a.createElement("p",{className:"date"},o.a.createElement("span",{className:"date-time"},ye(t,"monthAndDay")),o.a.createElement("span",{className:"week-time"},ye(t,"dayOfWeek"))),o.a.createElement("span",{className:"finished-count"},"\u5b8c\u6210\u4e86 ",a.length," \u4e2a\u4efb\u52a1")),o.a.createElement("div",{className:"details"},a.map((function(e){return o.a.createElement(Oe,{key:e.id,todo:e,type:"completed"})}))))}))},Ce=function(e){return e.todos.map((function(e){return o.a.createElement("div",{key:e.id},o.a.createElement(Oe,{key:e.id,todo:e,type:"deleted"}))}))},Ne=function(e){function t(e){var a;return Object(te.a)(this,t),(a=Object(ne.a)(this,Object(oe.a)(t).call(this,e))).state={tabIndex:"1",deletedTodosEachPage:e.deletedTodosByPage[0],completedDatesEachPage:e.completedDatesByPage[0]},a}return Object(re.a)(t,e),Object(ae.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"todo-history"},o.a.createElement(ve.a,{className:"todo-history-tabs",type:"card",activeKey:this.state.tabIndex,onChange:function(t){return e.setState({tabIndex:t})}},o.a.createElement(ke,{className:"todo-history-tab-pane",tab:"\u5df2\u5b8c\u6210\u7684\u4efb\u52a1",key:"1"},o.a.createElement(je,{dates:this.state.completedDatesEachPage,todos:this.props.completedTodosByDay}),o.a.createElement(fe.a,{className:"pagination",total:this.props.completedDates.length,onChange:function(t){e.setState({completedDatesEachPage:e.props.completedDatesByPage[t-1]})},pageSize:1})),o.a.createElement(ke,{className:"todo-history-tab-pane",tab:"\u5df2\u5220\u9664\u7684\u4efb\u52a1",key:"2"},o.a.createElement(Ce,{todos:this.state.deletedTodosEachPage}),o.a.createElement(fe.a,{className:"pagination",total:this.props.deletedTodos.length,onChange:function(t){e.setState({deletedTodosEachPage:e.props.deletedTodosByPage[t-1]})},pageSize:10}))))}}]),t}(o.a.Component),we=Object(s.b)((function(e,t){var a=J(e,P),n=J(e,A),o=Q(n,"completed_at"),r=Object.keys(o).sort((function(e,t){return Date.parse(t)-Date.parse(e)})),c=be(r,1),s=be(a,10);return Object(h.a)({completedTodosByDay:o,completedDates:r,completedDatesByPage:c,deletedTodos:a,deletedTodosByPage:s},t)}))(Ne),De=(a(293),a(166)),xe=(a(307),a(168)),Se=(a(298),function(e){function t(e){var a;return Object(te.a)(this,t),(a=Object(ne.a)(this,Object(oe.a)(t).call(this,e))).updateTomato=function(e){var t;return b.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,b.a.awrap(_.put("tomatoes/".concat(a.props.tomato.id),e));case 3:t=n.sent,a.props.updateTomato(t.data.resource),n.next=9;break;case 7:n.prev=7,n.t0=n.catch(0);case 9:case"end":return n.stop()}}),null,null,[[0,7]])},a.submitChange=function(){a.updateTomato({description:a.state.textContent}),a.setState({editing:!1})},a.onKeyup=function(e){13===e.keyCode&&""!==a.state.textContent&&a.submitChange()},a.state={editing:!1,textContent:a.props.tomato.description||"\u8fd9\u662f\u4e00\u4e2a\u6ca1\u6709\u63cf\u8ff0\u7684\u756a\u8304"},a}return Object(re.a)(t,e),Object(ae.a)(t,[{key:"render",value:function(){var e=this,t=o.a.createElement("div",{className:"edit-filed"},o.a.createElement("input",{type:"text",value:this.state.textContent,onChange:function(t){e.setState({textContent:t.target.value})},onKeyUp:this.onKeyup})),a=o.a.createElement("span",{className:"description"},this.props.tomato.description||"\u8fd9\u662f\u4e00\u4e2a\u6ca1\u6709\u63cf\u8ff0\u7684\u756a\u8304"),n=null;"finished"===this.props.type?n=o.a.createElement("span",{className:"time"},Object(W.a)(Object(F.a)(this.props.tomato.started_at),"HH:mm")," -",Object(W.a)(Object(F.a)(this.props.tomato.ended_at),"HH:mm")):"aborted"===this.props.type&&(n=o.a.createElement("span",{className:"time"},ye(this.props.tomato.started_at,"monthAndDay")));var r=null;return this.state.editing?r=o.a.createElement("div",{className:"action"},o.a.createElement("span",{onClick:function(){return e.submitChange()}},"\u63d0\u4ea4"),o.a.createElement("span",{onClick:function(){return e.setState({editing:!1})}},"\u53d6\u6d88")):"finished"===this.props.type?r=o.a.createElement("div",{className:"action"},o.a.createElement("span",{onClick:function(){return e.setState({editing:!0})}},"\u7f16\u8f91"),o.a.createElement("span",{onClick:function(){return e.updateTomato({aborted:!0})}},"\u5220\u9664")):"aborted"===this.props.type&&(r=o.a.createElement("div",{className:"action"},o.a.createElement("span",{onClick:function(){return e.setState({editing:!0})}},"\u7f16\u8f91"))),o.a.createElement("div",null,o.a.createElement("div",{className:"tomato-history-item ".concat(this.state.editing?"editing":"")},o.a.createElement("div",{className:"text"},n,this.state.editing?t:a),r))}}]),t}(o.a.Component)),_e={updateTomato:j.updateTomato},Pe=Object(s.b)((function(e,t){return Object(h.a)({},t)}),_e)(Se),Ae=(a(299),ve.a.TabPane),Be=function(e){return e.dates?e.dates.map((function(t){var a=e.tomatoes[t],n=a.reduce((function(e,t){return e+Date.parse(t.ended_at)-Date.parse(t.started_at)}),0);return o.a.createElement("div",{key:t,className:"daily-tomatoes"},o.a.createElement("div",{className:"title"},o.a.createElement("p",{className:"date"},o.a.createElement("span",{className:"date-time"},ye(t,"monthAndDay")),o.a.createElement("span",{className:"week-time"},ye(t,"dayOfWeek"))),o.a.createElement("p",{className:"finished-count"},"\u5b8c\u6210\u4e86 ",a.length," \u4e2a\u756a\u8304"),o.a.createElement("p",{className:"total-time"},"\u603b\u8ba1 ",function(e){var t=Math.floor(e/1e3);if(t<60)return"".concat(t," \u79d2");var a=Math.floor(t/60);if(a<60)return"".concat(a," \u5206\u949f");var n=Math.floor(a/60);return"".concat(n," \u5c0f\u65f6 ").concat(Math.floor(a%60)," \u5206\u949f")}(n))),o.a.createElement("div",{className:"details"},a.map((function(e){return o.a.createElement(Pe,{key:e.id,tomato:e,type:"finished"})}))))})):o.a.createElement("div",null)},Ie=function(e){return e.tomatoes.map((function(e){return o.a.createElement("div",{key:e.id},o.a.createElement(Pe,{key:e.id,tomato:e,type:"aborted"}))}))},Me=function(e){function t(e){var a;return Object(te.a)(this,t),(a=Object(ne.a)(this,Object(oe.a)(t).call(this,e))).addTomato=function(){var e,t;return b.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return""===a.state.description&&a.setState({description:"\u8fd9\u662f\u4e00\u4e2a\u6ca1\u6709\u63cf\u8ff0\u7684\u756a\u8304"}),e=new Date(Date.parse(a.state.startedAt._d)+15e5),n.prev=2,n.next=5,b.a.awrap(_.post("tomatoes",{started_at:a.state.startedAt,ended_at:e,description:a.state.description,manually_created:!0}));case 5:t=n.sent,a.props.addTomato(t.data.resource),a.setState({addModel:!1}),n.next=12;break;case 10:n.prev=10,n.t0=n.catch(2);case 12:case"end":return n.stop()}}),null,null,[[2,10]])},a.onKeyup=function(e){13===e.keyCode&&a.addTomato()},a.state={addModel:!1,startedAt:new Date,description:"",abortedTomatoesEachPage:e.abortedTomatoesByPage[0],abortedCurrent:1,finishedCurrent:1},a}return Object(re.a)(t,e),Object(ae.a)(t,[{key:"render",value:function(){var e=this,t=o.a.createElement(ce.a,{title:"\u8865\u8bb0\u4e00\u4e2a\u756a\u8304",visible:this.state.addModel,onOk:this.addTomato,onCancel:function(){return e.setState({addModel:!1})}},o.a.createElement("div",{className:"add-model-item"},o.a.createElement("span",null,"\u756a\u8304\u7684\u5f00\u59cb\u65f6\u95f4\uff1a"),o.a.createElement(xe.a,{placeholder:"",showTime:!0,onOk:function(t){return e.setState({startedAt:t})},onChange:function(t){return e.setState({startedAt:t})}})),o.a.createElement("div",{className:"add-model-item"},o.a.createElement("span",null,"\u756a\u8304\u63cf\u8ff0\uff1a"),o.a.createElement(Y.a,{type:"text",onChange:function(t){return e.setState({description:t.target.value})},onKeyUp:this.onKeyup})));return o.a.createElement("div",{className:"tomato-history"},t,o.a.createElement(ve.a,{className:"tomato-history-tabs",type:"card"},o.a.createElement(Ae,{className:"tomato-history-tab-pane",tab:"\u5b8c\u6210\u7684\u756a\u8304",key:"1"},o.a.createElement(De.a,{content:"\u8865\u8bb0\u756a\u8304"},o.a.createElement(ee.a,{onClick:function(){return e.setState({addModel:!0})},icon:"plus"})),o.a.createElement(Be,{dates:this.props.finishedDatesByPage[this.state.finishedCurrent-1],tomatoes:this.props.finishedTomatoesByDay}),o.a.createElement(fe.a,{className:"pagination",total:this.props.finishedDates.length,onChange:function(t){e.setState({finishedCurrent:t})},pageSize:1})),o.a.createElement(Ae,{className:"tomato-history-tab-pane",tab:"\u88ab\u6253\u65ad\u7684\u756a\u8304",key:"2"},o.a.createElement(Ie,{tomatoes:this.props.abortedTomatoesByPage[this.state.abortedCurrent-1]}),o.a.createElement(fe.a,{className:"pagination",total:this.props.abortedTomatoes.length,onChange:function(t){e.setState({abortedCurrent:t})},pageSize:10}))))}}]),t}(o.a.Component),Ue={addTomato:j.addTomato},Ke=Object(s.b)((function(e,t){var a=L(e,U),n=L(e,I),o=Q(n,"started_at"),r=Object.keys(o).sort((function(e,t){return Date.parse(t)-Date.parse(e)})),c=be(a,10),s=be(r,1);return Object(h.a)({finishedTomatoes:n,finishedTomatoesByDay:o,abortedTomatoes:a,abortedTomatoesByPage:c,finishedDates:r,finishedDatesByPage:s},t)}),Ue)(Me),He=(a(300),function(e){function t(e){var a;Object(te.a)(this,t),(a=Object(ne.a)(this,Object(oe.a)(t).call(this,e))).onClick=function(e){a.setState({currentIndex:e.currentTarget.getAttribute("data-index")})};var n=150,o=50;return document.body.clientWidth>=500&&(n=240,o=60),a.state={currentIndex:"1",graphWidth:n,graphHeight:o},a}return Object(re.a)(t,e),Object(ae.a)(t,[{key:"render",value:function(){var e;switch(this.state.currentIndex){case"1":e=o.a.createElement(Ke,null);break;case"2":e=o.a.createElement(we,null)}var t=o.a.createElement("ul",null,o.a.createElement("li",{className:"statistics-item ".concat("1"===this.state.currentIndex?"active":""),onClick:this.onClick,"data-index":"1"},o.a.createElement("div",{className:"text"},o.a.createElement("p",null,"\u756a\u8304\u5386\u53f2"),o.a.createElement("p",null,"\u7d2f\u8ba1\u5b8c\u6210\u756a\u8304"),o.a.createElement("p",null,this.props.finishedTomatoes.length)),o.a.createElement(he,{data:this.props.finishedTomatoesByDay,totalFinishCount:this.props.finishedTomatoes.length,width:this.state.graphWidth,height:this.state.graphHeight})),o.a.createElement("li",{className:"statistics-item ".concat("2"===this.state.currentIndex?"active":""),onClick:this.onClick,"data-index":"2"},o.a.createElement("div",{className:"text"},o.a.createElement("p",null,"\u4efb\u52a1\u5386\u53f2"),o.a.createElement("p",null,"\u7d2f\u8ba1\u5b8c\u6210\u4efb\u52a1"),o.a.createElement("p",null,this.props.completedTodos.length)),o.a.createElement(he,{data:this.props.completedTodosByDay,totalFinishCount:this.props.completedTodos.length,width:this.state.graphWidth,height:this.state.graphHeight})));return o.a.createElement("div",{className:"statistics"},t,o.a.createElement("div",{className:"history-details"},e))}}]),t}(o.a.Component)),We=Object(s.b)((function(e,t){var a=e.todos,n=J(e,A),o=Q(n,"completed_at"),r=L(e,I),c=Q(r,"ended_at");return Object(h.a)({todos:a,completedTodos:n,completedTodosByDay:o,finishedTomatoes:r,finishedTomatoesByDay:c},t)}))(He),Fe=(a(301),a(167)),ze=a.n(Fe),Je={initTodos:j.initTodos,initTomatoes:j.initTomatoes},Le=Object(s.b)((function(e,t){return Object(h.a)({},t)}),Je)((function(e){var t=o.a.useState({}),a=Object(T.a)(t,2),n=a[0],r=a[1],c=Object(m.f)();o.a.useEffect((function(){!function(){var e;b.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,b.a.awrap(_.get("me"));case 3:e=t.sent,r(e.data),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),401===t.t0.response.status||g.a.error("\u7f51\u7edc\u597d\u50cf\u6709\u70b9\u4e0d\u592a\u597d\u54e6\uff0c\u4e00\u4f1a\u513f\u518d\u8bd5\u5427");case 10:case"end":return t.stop()}}),null,null,[[0,7]])}(),function(){var t,a;b.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,b.a.awrap(_.get("todos"));case 3:t=n.sent,a=t.data.resources.map((function(e){return Object.assign({},e,{editing:!1})})),e.initTodos(a),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),401===n.t0.response.status||g.a.error("\u7f51\u7edc\u597d\u50cf\u6709\u70b9\u4e0d\u592a\u597d\u54e6\uff0c\u4e00\u4f1a\u513f\u518d\u8bd5\u5427");case 11:case"end":return n.stop()}}),null,null,[[0,8]])}(),function(){var t;b.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,b.a.awrap(_.get("tomatoes"));case 3:t=a.sent,e.initTomatoes(t.data.resources),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),401===a.t0.response.status||g.a.error("\u7f51\u7edc\u597d\u50cf\u6709\u70b9\u4e0d\u592a\u597d\u54e6\uff0c\u4e00\u4f1a\u513f\u518d\u8bd5\u5427");case 10:case"end":return a.stop()}}),null,null,[[0,7]])}()}),[e]);var s=function(){localStorage.setItem("x-token",""),c.push("/login")};return o.a.createElement("div",{id:"home"},o.a.createElement("header",null,o.a.createElement("div",{className:"logo"},o.a.createElement("img",{src:ze.a,alt:"logo"})),o.a.createElement(f.a,{overlay:function(){return o.a.createElement(v.a,null,o.a.createElement(v.a.Item,{key:"1",onClick:s},o.a.createElement(E.a,{type:"logout"}),"\u6ce8\u9500"))}},o.a.createElement("div",null,o.a.createElement("span",{className:"user"},n&&n.account)," ",o.a.createElement(E.a,{type:"down"})))),o.a.createElement("main",null,o.a.createElement(me,null),o.a.createElement(Z,null)),o.a.createElement(We,null))})),Qe=(a(303),function(){var e=o.a.useState(),t=Object(T.a)(e,2),a=t[0],n=t[1],r=o.a.useState(),c=Object(T.a)(r,2),s=c[0],i=c[1],l=Object(m.f)(),d=function(){return b.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.awrap(_.post("sign_in/user",{account:a,password:s}));case 3:l.push("/"),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),422===e.t0.response.status?g.a.warning("\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"):g.a.warning("\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5");case 9:case"end":return e.stop()}}),null,null,[[0,6]])},u=function(){return""===a?(g.a.warning("\u7528\u6237\u540d\u4e0d\u80fd\u4e3a\u7a7a\u54e6"),!1):""!==s||(g.a.warning("\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a\u54e6"),!1)};return o.a.createElement("div",{id:"login"},o.a.createElement("h1",null,"\u6b22\u8fce\u767b\u5f55\u756a\u8304\u95f9\u949f"),o.a.createElement(Y.a,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d",value:a,onChange:function(e){return n(e.target.value)}}),o.a.createElement(Y.a.Password,{placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801",value:s,onChange:function(e){return i(e.target.value)},onKeyUp:function(e){13===e.keyCode&&u()&&d()}}),o.a.createElement(ee.a,{type:"primary",onClick:function(){u()&&d()}},"\u767b\u5f55"),o.a.createElement("p",null,"\u5982\u679c\u8fd8\u6ca1\u6709\u8d26\u53f7\uff0c\u8bf7",o.a.createElement(p.b,{to:"/register"},"\u70b9\u51fb\u8fd9\u91cc\u6ce8\u518c")))}),Ye=(a(304),function(){var e=o.a.useState(),t=Object(T.a)(e,2),a=t[0],n=t[1],r=o.a.useState(),c=Object(T.a)(r,2),s=c[0],i=c[1],l=o.a.useState(),d=Object(T.a)(l,2),u=d[0],h=d[1],f=Object(m.f)(),v=function(){return b.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.awrap(_.post("sign_up/user",{account:a,password:s,password_confirmation:u}));case 3:f.push("/"),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),422===e.t0.response.status?g.a.warning("\u7528\u6237\u5df2\u5b58\u5728\uff0c\u8bf7\u6362\u4e00\u4e2a\u7528\u6237\u540d\u518d\u5c1d\u8bd5"):g.a.warning("\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5");case 9:case"end":return e.stop()}}),null,null,[[0,6]])},E=function(){return""===a?(g.a.warning("\u7528\u6237\u540d\u4e0d\u80fd\u4e3a\u7a7a\u54e6"),!1):""===s?(g.a.warning("\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a\u54e6"),!1):u===s||(g.a.warning("\u4e24\u6b21\u8f93\u5165\u7684\u5bc6\u7801\u4e0d\u4e00\u81f4\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"),!1)};return o.a.createElement("div",{id:"register"},o.a.createElement("h1",null,"\u6ce8\u518c\u4e00\u4e2a\u756a\u8304\u8d26\u53f7"),o.a.createElement(Y.a,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d",value:a,onChange:function(e){return n(e.target.value)}}),o.a.createElement(Y.a.Password,{placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801",value:s,onChange:function(e){return i(e.target.value)}}),o.a.createElement(Y.a.Password,{placeholder:"\u518d\u8f93\u5165\u4e00\u904d\u5bc6\u7801",value:u,onChange:function(e){return h(e.target.value)},onKeyUp:function(e){13===e.keyCode&&E()&&v()}}),o.a.createElement(ee.a,{type:"primary",onClick:function(){E()&&v()}},"\u6ce8\u518c"),o.a.createElement("p",null,"\u5982\u679c\u5df2\u7ecf\u6709\u8d26\u53f7\u4e86\uff0c\u8bf7",o.a.createElement(p.b,{to:"/login"},"\u70b9\u51fb\u8fd9\u91cc\u767b\u5f55")))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(305);c.a.render(o.a.createElement(s.a,{store:u},o.a.createElement((function(){return o.a.createElement(p.a,null,o.a.createElement(m.c,null,o.a.createElement(m.a,{path:"/login"},o.a.createElement(Qe,null)),o.a.createElement(m.a,{path:"/register"},o.a.createElement(Ye,null)),o.a.createElement(m.a,{path:"/"},o.a.createElement(Le,null))))}),null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[173,1,2]]]);
//# sourceMappingURL=main.8d1452dd.chunk.js.map